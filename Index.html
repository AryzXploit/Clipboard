<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>EME Fingerprinting PoC</title>
  <style>
    body { font-family: monospace; background:#111; color:#eee; padding:20px; }
    table { border-collapse: collapse; margin-top:20px; }
    th, td { border:1px solid #666; padding:6px 10px; }
    th { background:#222; }
    .ok { color: #0f0; }
    .fail { color: #f33; }
  </style>
</head>
<body>
  <h2>Encrypted Media Extensions Fingerprinting PoC</h2>
  <p>Browser ini dukung keySystem & codec apa aja tanpa permission.</p>
  <table id="results">
    <thead>
      <tr><th>KeySystem</th><th>Codec</th><th>Status</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const keySystems = [
      "com.widevine.alpha",
      "com.microsoft.playready",
      "org.w3.clearkey",
      "com.apple.fps.1_0"
    ];

    const codecs = [
      'video/mp4; codecs="avc1.42E01E"',
      'video/mp4; codecs="avc1.58A01E"',
      'video/webm; codecs="vp8"',
      'video/webm; codecs="vp9"',
      'video/mp4; codecs="av01.0.05M.08"'
    ];

    const tbody = document.querySelector("#results tbody");

    async function checkEME() {
      if (!navigator.requestMediaKeySystemAccess) {
        document.body.innerHTML += "<p>❌ EME API not supported</p>";
        return;
      }

      for (const ks of keySystems) {
        for (const codec of codecs) {
          const config = [{
            initDataTypes: ["cenc"],
            videoCapabilities: [{ contentType: codec }]
          }];

          try {
            const access = await navigator.requestMediaKeySystemAccess(ks, config);
            const row = `<tr><td>${ks}</td><td>${codec}</td><td class="ok">✅ Supported</td></tr>`;
            tbody.innerHTML += row;
          } catch (e) {
            const row = `<tr><td>${ks}</td><td>${codec}</td><td class="fail">❌ Not supported</td></tr>`;
            tbody.innerHTML += row;
          }
        }
      }
    }

    checkEME();
  </script>
</body>
</html>
